 

**随** **堂** **测** **试** **试** **卷（****A****）**

 

 **2022-2023**  **学年第 1** **学期**       **课程名称** **数据库系统原理-****课内实验**   

![文本框: 注意事项： l	运行Navicat Premium 15，新建查询窗口，在查询窗口中写出代码并执行。 l	考试过程中，考生独立完成，不得讨论和抄袭；不得携带U盘等拷贝设备。 l	考试结束，将查询文件保存，文件名为：学号姓名，通过“极域”上交。 l	 ](21%E7%BA%A7%E3%80%8A%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E3%80%8B%E8%AF%BE%E5%86%85%E5%AE%9E%E9%AA%8C%20%E6%B5%8B%E8%AF%95A.assets/clip_image001.gif) 



**考试时间： 60****分钟**     **考试类型**   **开卷**     **适用班级 21****级大数据1-2****班** 

 

 

 

 

**一、**  **运用T-SQL语言创建数据库及表。（第1小题8分，第2小题32分，共40分）**

**1、****建立网上图书销售管理信息系统的数据库，名称为：BookSale学号后四位（如：BookSale0101）。**

**2、****在第1小题建立的数据库中创建表图书种类信息表(Bcategory)图书信息表(Book)、会员信息表(Vip)、购买订单表(Orders)。四个表的结构和数据如下表1-8所示。**

**表****1 B****category****(****图书种类表****)**

| **列名** | **数据类型** | **可否为空** | **含义**       |
| -------- | ------------ | ------------ | -------------- |
| BCid     | Char(1)      | 否           | 图书种类(主键) |
| BCname   | varchar(20)  | 否           | 图书种类名称   |

 

**表****2 B****category****(****图书种类表****)****中的数据**

| **BCid** | **BCname**     |
| -------- | -------------- |
| B        | 哲学           |
| F        | 经济           |
| I        | 文学           |
| O        | 数理科学和化学 |
| T        | 工业技术       |

 

**表****3 Book(****图书信息表****)**

| **列名** | **数据类型** | **可否为空** | **含义**       |
| -------- | ------------ | ------------ | -------------- |
| Bno      | Char(5)      | 否           | 图书编号(主键) |
| Bname    | varchar(20)  | 否           | 图书名称       |
| Bprice   | decimal(6,2) | 否           | 图书单价       |
| Bnum     | int unsigned | 可           | 图书库存       |
| Bcid     | Char(1)      | 可           | 图书种类(外键) |

 

**表****4 Book(****图书信息表****)****中的数据**

| Bno   | Bname          | Bprice | Bnum | Bcid |
| ----- | -------------- | ------ | ---- | ---- |
| 10001 | 算法与数据结构 | 79.80  | 100  | O    |
| 10002 | 数据库系统原理 | 31.60  | 80   | O    |
| 20001 | 见字如面       | 59.90  | 95   | I    |
| 20002 | 平凡的世界     | 61.80  | 85   | I    |
| 10003 | WEB编程技术    | 89.90  | 75   | O    |

 

**表****5** **会员信息表(Vip)**

| **列名** | **数据类型**    | **可否为空** | **含义**       |
| -------- | --------------- | ------------ | -------------- |
| Vno      | char(6)         | 否           | 会员编号(主键) |
| Vname    | varchar(8)      | 否           | 会员昵称       |
| Vsex     | enum(’男’,’女’) | 否           | 会员性别       |
| Vtel     | char(11)        | 可           | 会员联系电话   |
| Vaddress | varchar(50)     | 可           | 收货地址       |

 

**表****6** **会员信息表(Vip)****中的数据**

| Vno    | Vname | Vsex | Vtel        | Vaddress               |
| ------ | ----- | ---- | ----------- | ---------------------- |
| 105804 | 李旭  | 男   | 18145615012 | 广西北海南珠大道1号    |
| 250856 | 张诚  | 男   | 15844512451 | 广西桂林金鸡岭6号      |
| 300825 | 王萍  | 女   | 18945614571 | 北京西城区华仁路小区   |
| 401831 | 刘云  | 女   | 13445454511 | 天津河北区新纬路1号    |
| 410841 | 李莉  | 女   | 15478945418 | 上海市闵行区申贵路15号 |

 

**表****7** **购买订单表(Orders)**

| **列名** | **数据类型** | **可否为空** | **含义**                 |
| -------- | ------------ | ------------ | ------------------------ |
| Oid      | int          | 否           | 订单序号(主键，自动增长) |
| Vno      | char(6)      | 否           | 会员编号(外键)           |
| Bno      | Char(5)      | 否           | 图书编号(外键)           |
| Onum     | int          | 否           | 购买数量，正整数         |
| XDtime   | datetime     | 否           | 下单时间                 |
| SHtime   | datetime     | 可           | 收货时间                 |

 

**表****8** **购买订单表(Orders)****中的数据**

| **Vno** | **Bno** | **Onum** | **XDtime**          | **SHtime**          |
| ------- | ------- | -------- | ------------------- | ------------------- |
| 105804  | 10001   | 1        | 2022-09-01 00:10:10 | 2022-09-03 10:10:10 |
| 250856  | 10001   | 2        | 2022-09-01 00:00:10 | 2022-09-03 08:10:00 |
| 250856  | 10002   | 1        | 2022-09-01 00:00:10 | 2022-09-03 08:10:00 |
| 401831  | 10002   | 2        | 2022-10-10 13:00:05 | 2022-10-12 19:05:15 |
| 410841  | 20002   | 1        | 2022-12-16 12:00:03 | NULL                |
| 410841  | 10001   | 3        | 2022-12-16 12:00:03 | NULL                |

 

**二、用SQL语言完成以下查询操作。（共60分，每题6分）。**

**1****、图书编号按照升序进行排序，备份前三本图书的信息到数据表“Book_A”中。**

**2****、查询会员性别为“男”的详细购买记录（包括会员信息、订单信息）。**

**3****、查询单笔订单中购买数量大于等于2的图书编号、图书名称及购买的会员编号。**

**4****、查询订单表中各会员购买图书的总数，从高到低排序。**

**5****、查询“文学”类的图书购买情况（包括订单信息、图书信息）。**

**6****、将编号为“10001”的图书改名为‘数据结构与算法'，价格调整为原来8折。**

**7****、查询购买的图书价格均大于50元的会员信息及其所购买的图书信息。**

**8****、将“数理科学和化学”类别的图书库存各增加20本。**

**9****、为收货时间不为空的订单创建新视图，名称为：V_Order（选择会员编号、会员昵称、图书名称和购买数量）。**

**10****、创建一个用户user1,密码为‘8888’，并分配查询视图V_Order的权限。**