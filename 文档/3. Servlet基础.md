## 案例3-1实现第一个Servlet程序

### 一、案例描述

1、考核知识点

   名称：实现第一个Servlet程序

  编号：028003003

2、练习目标

Ø 掌握实际开发中Servlet程序的基本实现和使用。

3、需求分析

  由于大多数Web应用都是通过HTTP协议和客户端进行交互，且在实际开发servlet中多是编写基于HTTP协议请求的servlet，在Servlet 接口中，专门提供了一个抽象类javax.servlet.http.HttpServlet，它是GenericServlet的子类（GenericServlet是Servlet接口的实现类），专门用于创建应用于HTTP协议的Servlet。为了读者可以更好地了解实际开发中的servle程序实现，本案例将演示如何编写基于HTTP协议请求的servlet。

 

4、设计思路（实现原理）

1） 创建ServletDemo1类继承Httpservlet类，

2） 在ServletDemo1中重写开发常用的doGet()方法和doPost()方法并完成处理操作

3） 在web.xml中配置初始化参数和类的映射

​    4）通过浏览器访问ServletDemo1，展现页面servlet处理响应信息。

### 二、案例实现

编写ServletDemo1，浏览器显示的结果如下图所示：

![img](3.%20Servlet%E5%9F%BA%E7%A1%80.assets/clip_image002.jpg)

 

## 案例3-2 HttpServlet

### 一、案例描述

1、 考核知识点

名称：HttpServlet

编号：028003005

2、 练习目标

Ø 掌握HttpServlet的doGet()方法和doPost()方法

3、 需求分析

由于大多数Web应用都是通过HTTP协议和客户端进行交互，因此，在Servlet 接口中，提供了

一个抽象类javax.servlet.http.HttpServlet，它是GenericServlet的子类，专门用于创建应用于HTTP协议的Servlet。为了读者可以更好地了解HttpServlet，本案例将演示重写HttpServlet中的doGet()方法和doPost()方法打印出九九乘法表。

4、 设计思路（实现原理）

查看HttpServlet源代码的service ()方法，在方法中可以看到 get请求调用doGet()方法，post请求调用doPost()方法，那么就可以直接重写doGet ()和doPost ()不需要重写service ()方法了。

1）       编写ServletDemo2类，在doGet ()方法和doPost()方法中用双重for循环打印九九乘法表

2）       配置web.xml文件

3）       编写get.html页面，设置表单提交方式为get，表单页面使用input标签配置一个按钮，单击按钮可以get方式访问ServletDemo2类

4）       编写post.html页面，设置表单提交方式为post，表单页面使用input标签配置一个按钮，单击按钮可以post方式访问到ServletDemo2类

5）       通过浏览器分别访问get.html和post.html页面，单击其页面上的按钮，对ServletDemo2 进行访问

### 二、案例实现            

部分核心代码提示：

1.九九乘法表代码

for (int i = 1; i <= 9; i++) {

​      for (int j = 1; j <= i; j++) {

​       resp.getWriter().print(j + "*" + i + "=" + j * i+" ");

}

​           }

编写get.html文件:

  <form action="/chapter03/ServletDemo2" method="get">

​    <input type="submit" value="提交">

  </form>

编写post.html文件:

  <form action="/chapter03/ServletDemo2" method="post">

​    <input type="submit" value="提交">

  </form>

 

启动Tomcat服务器，在地址栏中输入http://localhost:8080/chapter03/get.html，浏览器显示的结果如下图所示：

 

![img](3.%20Servlet%E5%9F%BA%E7%A1%80.assets/clip_image004.jpg)

单击提交按钮，显示的结果如下图所示：

![img](3.%20Servlet%E5%9F%BA%E7%A1%80.assets/clip_image006.jpg)

在地址栏中输入http://localhost:8080/chapter03/post.html，浏览器显示的结果如下图所示：

![img](3.%20Servlet%E5%9F%BA%E7%A1%80.assets/clip_image008.jpg)

单击提交按钮，显示的结果如下图所示：

![img](3.%20Servlet%E5%9F%BA%E7%A1%80.assets/clip_image010.jpg)

 

## 案例3-3 用ServletConfig对象读取配置文件

### 一、案例描述

1、考核知识点

名称：ServletConfig接口

编号：028003008

2、练习目标

Ø 掌握ServletConfig对象的使用

3、需求分析

在Servlet运行期间，经常需要一些辅助信息，这些信息可以在web.xml文件中使用一个或多个<init-param>元素进行配置。当Tomcat初始化一个Servlet时，会将该Servlet的配置信息封装到一个ServletConfig对象中。为了让初学者熟悉ServletConfig对象，本案例将使用ServletConfig对象读取配置文件中的参数。

4、设计思路（实现原理）

4） 创建ServletDemo3类，

5） 在ServletDemo3中，用getInitParameterNames()方法获得所有参数

6） 在web.xml中配置初始化参数和类的映射

​    4）通过浏览器访问ServletDemo3，展现控制台输出的读取web.xml中的初始化参数

### 二、案例实现

在web.xml中配置ServletDemo3类及初始化数据：

  <servlet>

​    <servlet-name>ServletDemo3</servlet-name>

​    <servlet-class>cn.itcast.chapter03.servlet.ServletDemo3</servlet-class>

​    <init-param>

​      <param-name>encoding</param-name>

​      <param-value>UTF-8</param-value>

​    </init-param>

  </servlet>

  <servlet-mapping>

​    <servlet-name>ServletDemo3</servlet-name>

​    <url-pattern>/ServletDemo3</url-pattern>

  </servlet-mapping>

启动Tomcat服务器，在浏览器的地址栏中输入URL地址http://localhost:8080/chapter03/ServletDemo3，显示的结果如下图所示：

 

![img](3.%20Servlet%E5%9F%BA%E7%A1%80.assets/clip_image012.jpg)

### 三、案例总结

在本案例中，要访问ServletConfig对象的参数，首先要取得ServletConfig对象，然后调用它的getInitParameter();方法即可。在后面的学习中可以学到，要访问ServletConfig对象，JSP中直接使用config内置对象，但因为JSP编译后的servlet一般不会被加到web.xml中的，所以一般不会通过JSP来获取对本JSP编译后的servlet的配置参数。

## 案例3-4 ServletContext接口实现数据共享

### 一、案例描述

1、考核知识点

   名称：ServletContext接口

  编号：028003009

2、练习目标

Ø 掌握用ServletContext对象实现多个Servlet对象数据共享

3、需求分析

  由于一个Web应用中的所有Servlet共享同一个ServletContext对象，因此ServletContext对象的域属性可以被该Web应用中的所有Servlet访问。为了让初学者熟悉ServletContext对象，本案例将演示用ServletContext对象实现多个Servlet对象的数据共享

4、设计思路（实现原理）

统计网站的访问次数：

1） 创建两个Servlet，ServletDemo4用于存储，ServletDemo5用于显示

2） 在类ServletDemo4中给次数（count）设置一个初始值 0存入到 ServletContext中

3） 每次访问doGet()方法就会执行 count + 1，并将count值存入到 ServletContext中

4） 在类ServletDemo5中用getAttribute ("count")方法获取到count值

### 二、案例实现

​    创建类ServletDemo4，代码如下：

public class ServletDemo4 extends HttpServlet {

  @Override

  public void init() throws ServletException {

​    // 给次数设置一个初始值 0 

​    int count = 0;

​    // 将 0 存入到 ServletContext中

​    getServletContext().setAttribute("count", count);

  }

  public void doGet(HttpServletRequest request, HttpServletResponse response)

​      throws ServletException, IOException {

​    // 请补充代码

  }

  public void doPost(HttpServletRequest request, HttpServletResponse response)

​      throws ServletException, IOException {

​    doGet(request, response);

  }

}

创建类ServletDemo5，代码如下：

显示的Servlet的代码

public class ServletDemo5 extends HttpServlet {

 

  public void doGet(HttpServletRequest request, HttpServletResponse response)

​      throws ServletException, IOException {

​    // 请补充代码

  }

  public void doPost(HttpServletRequest request, HttpServletResponse response)

​      throws ServletException, IOException {

​    doGet(request, response);

  }

}

启动服务，访问http://localhost:8080/chapter03/ServletDemo4可看到浏览器显示如下图：

![img](3.%20Servlet%E5%9F%BA%E7%A1%80.assets/clip_image014.jpg)

刷新多次此页面后可看到浏览器显示如下图：

![img](3.%20Servlet%E5%9F%BA%E7%A1%80.assets/clip_image016.jpg)

访问http://localhost:8080/chapter03/ServletDemo5可看到浏览器显示如下图：

![img](3.%20Servlet%E5%9F%BA%E7%A1%80.assets/clip_image018.jpg)